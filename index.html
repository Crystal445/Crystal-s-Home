<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome to Crystal's Home</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            text-align: center; 
            padding: 50px; 
            background-color: #f4f4f4;
        }
        h1 {
            color: #2E86C1;
        }
        p {
            font-size: 18px;
            color: #333;
        }
    </style>
</head>
<body>
    <h1>Welcome, Mike & Crystal!</h1>
    <p>This is our special space on the web.</p>
    <p>More to come soon...</p>

     <!-- ðŸ”¹ Login Form (Place this here) -->
    <div id="login-form">
        <h2>Login</h2>
        <p id="auth-status">Not logged in.</p>
        <input type="email" id="email" placeholder=mkenne361@gmail.com>
        <input type="password" id="password" placeholder=xGTx-64EQM605Fw>
        <button onclick="login()">Login</button>
    </div>
    
<div id="crystal-message" style="border: 2px solid #2E86C1; padding: 15px; margin: 20px; background-color: #f0f8ff; text-align: center;">
   <h2 style="color: #2E86C1;">Message for Crystal</h2>
   <p id="message-content" style="font-size: 18px; color: #333;">Loading latest message...</p>
   <input type="text" id="new-message" placeholder="Type your message here..." style="width: 80%; padding: 5px; margin-top: 10px;">
   <button onclick="saveMessage()" style="padding: 5px 10px; margin-top: 10px; background-color: #2E86C1; color: white; border: none; cursor: pointer;">Update Message</button>
</div>

<script>
    const firebaseUrl = "https://crystal-home-d5071-default-rtdb.firebaseio.com/message.json";

    // Function to load message from Firebase
function listenForUpdates() {
    const database = firebase.database();
    const messageRef = database.ref("message"); // Adjust if needed

    messageRef.on("value", (snapshot) => {
        const data = snapshot.val();
       if (data && typeof data === "object" && data.message) {
    document.getElementById("message-content").innerText = data.message;
} else {
    document.getElementById("message-content").innerText = "No message found.";
}

    }, (error) => {
        console.error("Error listening for updates:", error);
    });
}

// Run listener when page loads
window.onload = function () {
    console.log("Listening for real-time updates...");
    listenForUpdates();
};


// Call the function when the page loads
window.onload = function () {
    console.log("Listening for real-time updates...");
    listenForUpdates();
};



    // Function to save message to Firebase
    async function saveMessage() {
        let newMessage = document.getElementById("new-message").value;

        if (newMessage.trim() !== "") {
            document.getElementById("message-content").innerText = newMessage;
            document.getElementById("new-message").value = "";

            let updatedData = JSON.stringify({ message: newMessage });

            try {
                await fetch(firebaseUrl, {
                    method: "PUT",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: updatedData
                });

                console.log("Message saved successfully!");
            } catch (error) {
                console.error("Error saving message:", error);
            }
        }
    }

    // Load message on page load
window.addEventListener("load", function () {
    console.log("Page loaded. Fetching latest message...");
   listenForUpdates(); // Ensures the function runs when the page loads
});
</script>






<p>Last updated: <span id="date-time"></span></p>
<script>
    window.onload = function() {
        document.getElementById("date-time").innerText = new Date().toLocaleString();
    };
</script>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
  // Your Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyCv81M0SQTT38AZSMs0I0snnMInIXuXpC8",
    authDomain: "crystal-home-d5071.firebaseapp.com",
    databaseURL: "https://crystal-home-d5071-default-rtdb.firebaseio.com",
    projectId: "crystal-home-d5071",
    storageBucket: "crystal-home-d5071.firebasestorage.app",
    messagingSenderId: "68398414606",
    appId: "1:68398414606:web:cdf79e1cb989e8093ff55f"
  };


import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
import { getDatabase, ref, onValue, set } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";
import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js";

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const database = getDatabase(app);
const auth = getAuth(app);


  // Authentication function
 function login() {
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    
    signInWithEmailAndPassword(auth, email, password)
        .then((userCredential) => {
            const user = userCredential.user;
            console.log("Logged in successfully!", user.email);
            document.getElementById("auth-status").innerText = "Logged in as " + user.email;
            
            // Once logged in, start listening for Firebase data
            listenForUpdates();
        })
        .catch((error) => {
            console.error("Login failed:", error.message);
            document.getElementById("auth-status").innerText = "Login failed. Try again.";
        });
}


  // Listen for Firebase auth state changes
  firebase.auth().onAuthStateChanged((user) => {
      if (user) {
          console.log("User is logged in:", user.email);
          document.getElementById("auth-status").innerText = "Logged in!";
          listenForUpdates(); // Fetch messages when authenticated
      } else {
          console.log("User is logged out.");
          document.getElementById("auth-status").innerText = "Not logged in.";
      }
  });
</script>




</body>
</html>
